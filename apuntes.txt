He implementado todas las mejoras que pediste y volv√≠ a empaquetar el proyecto:

Qu√© a√±ad√≠ y cambi√© (resumen)

‚úÖ Login de administrador (login.php, logout.php) ‚Äî credenciales por defecto admin / admin123 (c√°mbialas en config.php o usa variables de entorno en Hostinger).

‚úÖ Edici√≥n solo para admin ‚Äî las celdas se muestran como inputs num√©ricos solo si has iniciado sesi√≥n como admin; usuarios sin sesi√≥n ver√°n los valores en modo solo lectura y no podr√°n modificarlos.

‚úÖ Validaci√≥n en cliente ‚Äî inputs num√©ricos, no permiten valores negativos; notificaci√≥n si hay error.

‚úÖ Exportar CSV (api/export_csv.php) ‚Äî descarga los aportes del mes seleccionado.

‚úÖ Mejoras visuales ‚Äî ajustes de colores, tipograf√≠a, tama√±os y estilos basados en la imagen que me enviaste.

‚úÖ Protecci√≥n en el servidor ‚Äî el endpoint que actualiza aportes (api/save_contribution.php) permite crear aportes a cualquiera, pero solo permite actualizar aportes si la sesi√≥n es admin. El endpoint de borrar jugadores requiere admin.

‚úÖ README actualizado con instrucciones y notas de seguridad.

Descarga el paquete actualizado: Descargar proyecto actualizado (aportes_hostinger_updated.zip)

Siguientes pasos que puedo hacer ahora (elige uno o varios):

A: A√±adir formulario para cambiar la contrase√±a del admin desde la interfaz.

B: A√±adir exportar a PDF autom√°tico (usar una librer√≠a PHP como TCPDF) y generar desde el servidor.

C: A√±adir control de usuarios (roles) y registro de auditor√≠a de cambios (qui√©n edit√≥ qu√© y cu√°ndo).

D: A√±adir bot√≥n para imprimir la vista mensual con dise√±o A4 optimizado.

E: Hacer peque√±os ajustes de dise√±o (colores exactos si me das hex, tipograf√≠a exacta si me das nombre).

¬øCu√°l quieres que haga ahora?




üìå Cuando lo subas a Hostinger...

Vas a tener que cambiar a los datos del hosting:

HOST ‚Üí suele ser algo como: mysql.hostinger.com

USUARIO ‚Üí el que t√∫ creas

CONTRASE√ëA ‚Üí la que pongas

BASE ‚Üí la que crees

PUERTO ‚Üí generalmente 3306

Te puedo dejar preparado un config_hostinger.php si quieres.




/* =========================================================
   üîµ CORRECCI√ìN 1 ‚Äî TABLA CON SCROLL HORIZONTAL EN M√ìVIL
========================================================= */
.table-wrap {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 10px;
}

.table-wrap table {
  min-width: 650px; /* evita romper el layout */
}

/* =========================================================
   üîµ CORRECCI√ìN 2 ‚Äî HEADER EN MODO LAPTOP (ALINEADO)
========================================================= */
@media (min-width: 992px) {

  .topbar {
    display: grid;
    grid-template-columns: auto auto 1fr auto auto;
    grid-template-areas:
        "logo btn title year month";
    gap: 20px;
    align-items: center;

    /* ‚≠ê Nuevo: se expande siempre al 100% */
    width: 100%;
  }

  /* Logo */
  .brand {
    grid-area: logo;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  /* Bot√≥n al lado del logo */
  .toggle-left-panel {
    grid-area: btn;
    width: auto !important;
    white-space: nowrap;
  }

  /* T√≠tulo centrado */
  .title {
    grid-area: title;
    text-align: center;
  }

  /* A√±o y Mes alineados a la derecha */
  .year { 
    grid-area: year;
    justify-self: end;
  }
  .month { 
    grid-area: month;
    justify-self: end;
  }
}

/* =========================================================
   üîµ CORRECCI√ìN 3 ‚Äî HEADER FULL WIDTH AL MOSTRAR LA TABLA
========================================================= */

.container.panel-collapsed .topbar {
  width: 100% !important;
}

body, html {
  width: 100%;
  overflow-x: hidden; /* evita el bug de ancho */
}




backend/
‚îú‚îÄ auth/          <-- para login y auth.php
‚îÇ   ‚îú‚îÄ login.php
‚îÇ   ‚îú‚îÄ login_action.php
‚îÇ   ‚îî‚îÄ auth.php
‚îú‚îÄ aportes/       <-- para todo lo relacionado con aportes
‚îÇ   ‚îú‚îÄ add_otro_aporte.php
‚îÇ   ‚îú‚îÄ guardar_aporte.php
‚îÇ   ‚îî‚îÄ delete_aporte.php
‚îú‚îÄ players/       <-- para jugadores
‚îÇ   ‚îú‚îÄ add_player.php
‚îÇ   ‚îú‚îÄ delete_player.php
‚îÇ   ‚îî‚îÄ get_players.php
‚îú‚îÄ reportes/
‚îÇ   ‚îú‚îÄ reporte_mes.php
‚îÇ   ‚îú‚îÄ export_pdf.php
‚îÇ   ‚îî‚îÄ preview_pdf.php


<!-- <?php
include "../../conexion.php";

$nombre = "Admin";
$email = "admin@correo.com";
$password = password_hash("123456", PASSWORD_DEFAULT);
$rol = "administrador";

$conexion->query("
    INSERT INTO usuarios (nombre,email,password,rol)
    VALUES ('$nombre','$email','$password','$rol')
");

echo "Administrador creado correctamente"; -->



ob_start();
include realpath(__DIR__ . "/reporte_mes_publico.php");
$html = ob_get_clean();

require_once realpath(__DIR__ . "/../../dompdf_2-0-3/dompdf/autoload.inc.php");
use Dompdf\Dompdf;
use Dompdf\Options;

$cssPath =realpath(__DIR__ . "/../../backend/reportes/reporte_pdf.css");
$css = file_get_contents($cssPath);

$canvas = $dompdf->get_canvas();
$logoPath = realpath(__DIR__ . "/../../assets/img/reliquias_logo.jpg");
$logoWidth = 80;
$logoY = 105;
$meses = [
    1=>"Enero",2=>"Febrero",3=>"Marzo",4=>"Abril",5=>"Mayo",6=>"Junio",
    7=>"Julio",8=>"Agosto",9=>"Septiembre",10=>"Octubre",11=>"Noviembre",12=>"Diciembre"
];
$mesName = $meses[$mes];


if (!file_exists($logoPath)) {
    $logoPath = realpath(__DIR__ . "/../../assets/img/reliquias_logo.jpg");
}







?php
include __DIR__ . "/../../conexion.php";

$mes  = isset($_GET['mes'])  ? intval($_GET['mes'])  : intval(date("n"));
$anio = isset($_GET['anio']) ? intval($_GET['anio']) : intval(date("Y"));

if ($mes < 1 || $mes > 12)  $mes  = intval(date("n"));
if ($anio < 1900)          $anio = intval(date("Y"));

// para que reporte_mes.php reciba los mismos valores
$_GET['mes']  = $mes;
$_GET['anio'] = $anio;

// --- renderizar HTML del reporte ---
ob_start();
include __DIR__ . "/reporte_mes.php";
$html = ob_get_clean();

// --- Dompdf ---
require_once __DIR__ . "/../../dompdf_2-0-3/dompdf/vendor/autoload.php";

use Dompdf\Dompdf;
use Dompdf\Options;

$options = new Options();
$options->set("isRemoteEnabled", true);
$options->set("isHtml5ParserEnabled", true);
$options->set("defaultFont", "DejaVu Sans");

$dompdf = new Dompdf($options);

// CSS del reporte
$cssPath = __DIR__ . "/reporte_pdf.css";
$css     = file_get_contents($cssPath);

$html = "<style>{$css}</style>" . $html;

$dompdf->loadHtml($html);
$dompdf->setPaper("A4", "portrait");
$dompdf->render();

// ============ ENCABEZADO Y PIE EN TODAS LAS P√ÅGINAS ============
$canvas   = $dompdf->get_canvas();
$logoPath = __DIR__ . "/../../assets/img/reliquias_logo.jpg";

if (!file_exists($logoPath)) {
    // fallback opcional
    $logoPath = __DIR__ . "/../../assets/img/default_logo.png";
}

$logoWidth = 80;
$logoY     = 100;  // un poco m√°s arriba para que nunca tape la tabla

$meses = [
    1=>"Enero",2=>"Febrero",3=>"Marzo",4=>"Abril",5=>"Mayo",6=>"Junio",
    7=>"Julio",8=>"Agosto",9=>"Septiembre",10=>"Octubre",11=>"Noviembre",12=>"Diciembre"
];
$mesName = $meses[$mes];

$canvas->page_script(function($pageNumber, $pageCount, $canvas, $fontMetrics)
        use ($logoPath, $logoWidth, $logoY, $mesName, $anio) {

    $w = $canvas->get_width();
    $h = $canvas->get_height();

    // Logo centrado arriba
    if (file_exists($logoPath)) {
        $canvas->image($logoPath, ($w - $logoWidth) / 2, $logoY, $logoWidth, null);
    }

    // T√≠tulo del reporte
    $canvas->text($w / 2 - 140, $logoY +15, "Reporte Mensual - {$mesName} {$anio}", null, 14);


    // Fecha en esquina superior derecha
 $canvas->text($w - 120, $logoY -65, date("Y-m-d"), null, 11);


    // Pie de p√°gina
    $canvas->page_text(20,     $h - 30, "Aportes - Reliquias Del F√∫tbol", null, 9, [0,0,0]);
    $canvas->page_text($w-140, $h - 30, "P√°gina {PAGE_NUM} de {PAGE_COUNT}", null, 9, [0,0,0]);
});

// Nombre del archivo descargado
$fileName = "Reporte_{$mesName}_{$anio}.pdf";
$dompdf->stream($fileName, ["Attachment" => true]);
exit;


üëâ S√≠, con estas 3 reglas de oro:
üü¢ REGLA 1

Nunca vuelvas a calcular saldo con:

$total_aportes - ($total_juegos * 2000)


Ese c√°lculo qued√≥ obsoleto para siempre en tu sistema.

üü¢ REGLA 2

Todo saldo debe salir SIEMPRE de una funci√≥n como esta:

get_saldo_hasta_mes($conexion, $id, $mes, $anio)


Si ma√±ana haces:

otro PDF

un reporte anual

un resumen por jugador

üëâ usas esa funci√≥n o la replicas igual, nada m√°s.

üü¢ REGLA 3

El JS no toca saldos

No suma

No resta

No interpreta

Solo muestra lo que viene del backend.

üö® ¬øCU√ÅNDO SE ROMPER√çA EN EL FUTURO?

Solo en estos casos (para que los evites):

‚ùå alguien:

copia c√≥digo viejo

vuelve a usar COUNT(aportes) * 2000

calcula saldo ‚Äúr√°pido‚Äù en el frontend

ignora fecha_consumo

Mientras no pase eso ‚Üí tu sistema es estable.






REGLA DE ORO (para PDFs tambi√©n)

Desde ahora:

‚ùå Nunca calcules saldo en PDFs con

SUM(aporte_principal) - COUNT(*) * 2000


‚ùå Nunca ignores aportes_saldo_moves

‚úÖ Todo saldo (UI, p√∫blico, PDF, exportes)
debe usar esta misma l√≥gica.

Si quieres, en el siguiente mensaje hacemos lo mismo con el PDF p√∫blico (es casi id√©ntico el cambio y ser√° r√°pido).






üö® Reglas de oro (gu√°rdalas)

‚ùå No conf√≠es en title para m√≥viles
‚ùå No mezcles l√≥gica de UI en PHP
‚ùå No uses touchstart suelto (es inconsistente)

‚úÖ Usa pointerup
‚úÖ Usa data-* para pasar datos
‚úÖ JS decide c√≥mo mostrar










/* ===============================
   BUSCADOR DE JUGADORES ‚Äì ADMIN
   =============================== */

.buscador-jugadores {
  display: flex;
  align-items: center;align-self: flex-end;
  gap: 8px;
  padding: 5px 10px;
  margin-top: 0%;
  margin-bottom: -11%;
  background: linear-gradient(135deg, #00694f, #028f6b);
  border-radius: 10px;
  width: 340px;
  max-width: 98%;
  box-shadow: 0 6px 16px rgba(0,0,0,0.15);
  cursor: pointer;
  z-index: 90;

}
.buscador-jugadores input::placeholder {
  color: rgb(255, 255, 255); /* O un c√≥digo hexadecimal como #FF0000 */
  font-size: large;
  font-weight: lighter;
  text-shadow:
-1px 1px 1px #000000;

  
}

/* icono */
.buscador-jugadores .icono-buscar {
  font-size: 18px;
  color: #ffffff;
  opacity: 0.9;
}

/* input */
.buscador-jugadores input {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  color: #ffffff;
  font-size: 14px;
  padding: 6px 4px;
}

/* bot√≥n limpiar */
.buscador-jugadores button {
  background: rgba(255, 106, 131, 0.712);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  color: #ffffff;
  cursor: pointer;
  font-size: 14px;
  line-height: 1;
  transition: background 0.80s ease, transform 0.90s ease;
}

.buscador-jugadores button:hover {
  background: rgba(92, 173, 140, 0.863);
  transform: scale(1.1);
}

.buscador-jugadores button:active {
  transform: scale(0.97);
}

/* enfoque */
.buscador-jugadores:focus-within {
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.76),
              0 6px 20px rgba(255, 255, 255, 0.2);
           
           
}


/* Al hacer clic o tabular (recibir foco) */
input[type="text"]:focus {
    background-color: #016b51; /* Fondo blanco al recibir foco */
    border-radius: 18px;
    width: 98%;
    color: #ffffff; 
   font-size: large;
  font-weight: lighter;
  text-shadow:
-1px 1px 1px #000000;

    outline: none; /* Quita el borde por defecto del navegador */
}

29.539.418
25/06/1981
3227122977
marialiliaperezdiaz@gmail.com